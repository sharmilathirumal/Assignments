<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Employee Form</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body>
    <div class="container mt-5">
        <h2 class="mb-4">Employee Form</h2>
        <form onsubmit="AddEmployee(event)">
            <div class="row mb-3 align-items-center">
                <label for="name" class="col-sm-2 col-form-label">Employee Name:</label>
                <div class="col-sm-10">
                    <input type="text" class="form-control" id="name" name="name" placeholder="Enter employee name">
                </div>
            </div>
            <div class="row mb-3 align-items-center">
                <label for="email" class="col-sm-2 col-form-label">Employee Email:</label>
                <div class="col-sm-10">
                    <input type="email" class="form-control" id="email" name="email" placeholder="Enter employee email">
                </div>
            </div>
            <div class="row mb-3 align-items-center">
                <label for="location" class="col-sm-2 col-form-label">Employee Location:</label>
                <div class="col-sm-10">
                    <input type="text" class="form-control" id="location" name="location" placeholder="Enter location">
                </div>
            </div>
            <div class="row">
                <div class="col-sm-10 offset-sm-2">
                    <button type="submit" class="btn btn-primary">Submit</button>
                </div>
            </div>
        </form>
        <table class="table mt-3">
            <thead>
                <tr>
                    <th>Id</th>
                    <th>Name</th>
                    <th>Email</th>
                    <th>Location</th>
                </tr>
            </thead>
            <tbody id="tableContent">
            </tbody>
        </table>

        <script>
            function getAllData() {
                fetch("http://localhost:8080/employee/getAll")
                    .then(response => response.json())
                    .then(data => {
                        let rows = ``;
                        data.forEach(u => {
                            rows += `<tr>
                    <td>${u.employeeId}</td>
                    <td>${u.employeeName}</td>
                    <td>${u.employeeEmail}</td>
                    <td>${u.employeeLocation}</td>
                </tr>`;
                        });
                        document.getElementById("tableContent").innerHTML = rows;
                    })
                    .catch(error => console.error(error));
            }
            getAllData();

            function AddEmployee(event) {
                event.preventDefault();
                const employee = {
                    employeeName: document.getElementById("name").value,
                    employeeEmail: document.getElementById("email").value,
                    employeeLocation: document.getElementById("location").value
                };

                fetch("http://localhost:8080/employee/add", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify(employee)
                })
                    .then(response => response.text())
                    .then(result => {
                        console.log(result);
                        getAllData(); // refresh table
                        // clear form
                        document.getElementById("name").value = "";
                        document.getElementById("email").value = "";
                        document.getElementById("location").value = "";
                    })
                    .catch(error => console.error(error));
            }

           /* function deleteEmployee(id) {
                fetch(`http://localhost:8080/employee/delete/${id}`, { method: "DELETE" })
                    .then(response => response.text())
                    .then(result => getAllData())
                    .catch(error => console.error(error));
            }*/
        </script>

</body>

</html>